{% extends 'layout.html' %}
{% load static %}
{% block extrahead %}
{% endblock %}

{% block content %}
    <link rel="stylesheet" href="{% static 'gtp/chatgpt_result.css' %}">
    <main class="flex-grow-1">
        <div class = "container">
            <div class = "inner_container">

                <!-- 세션 또는 주제 선택 -->
                <form action="rechat" method="get">
                    <select name="session_id">
                        {% for session_id in sessions %}
                            <option value="{{ session_id }}" {% if session_id == current_session_id %}selected{% endif %}>{{ session_id }}</option>
                        {% endfor %}
                    </select>
                    <button type="submit">세션 선택</button>
                </form>

                <!-- 새로 추가된 부분: 이전 대화 내용 표시 -->
                <div class="chat_history">
                    {% for chat in chat_history %}
                        <div class="user_message">User: {{ chat.user_message }}</div>
                        <div class="gpt_response">GPT: {{ chat.gpt_response }}</div>
                        <hr>
                    {% endfor %}
                </div>

                <!-- "이어서 질문하기" 폼 -->
                <form class="form" action="rechat" method="post" entype="application/x-www-form-urlencoded">
                    {% csrf_token %}
                    <input type="hidden" name="session_id" value="{{ current_session_id }}">
                    <div><textarea id="question" name="question" placeholder="질문을 입력해주세요."></textarea></div>
                    <div class="button-container">
                        <button class="button-class" id="continue-button" type="submit">이어서 질문</button>
                    </div>
                </form>

                <!-- "새 채팅창" 버튼 -->
                <div class="button-container">
                    <button class="button-class" id="new-chat-button" onclick="window.location.href='/chatgpt'">새 채팅창</button>
                </div>


            </div>
        </div>
    </main>
{% endblock %}
